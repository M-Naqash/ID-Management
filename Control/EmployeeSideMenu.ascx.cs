using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class Control_EmployeeSideMenu : System.Web.UI.UserControl
{
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    protected void Page_Load(object sender, EventArgs e)
    {
        FormSession.FillSession("", null);
        PermSideMenu();
    }
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    protected void btnSideMenu_Click(object sender, EventArgs e)
    {
        LinkButton lb = (LinkButton)sender;
        Response.Redirect(lb.PostBackUrl);
    }
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    private void PermSideMenu()
    {
        btnCreateEmpManager.Enabled    = FormSession.getPerm("IMng");
        btnUpdateEmpManager.Enabled    = FormSession.getPerm("UMng");
        btnCreateEmpEmployee.Enabled   = FormSession.getPerm("IEmp");
        btnUpdateEmpEmployee.Enabled   = FormSession.getPerm("UEmp");
        btnCreateEmpContractor.Enabled = FormSession.getPerm("ICon");
        btnUpdateEmpContractor.Enabled = FormSession.getPerm("UCon");

        btnUpdateEmpType.Enabled       = FormSession.getPerm("UEmpType");
        btnSearchEmployee.Enabled      = FormSession.getPerm("SEmployees");
        btnEmpFP.Enabled               = FormSession.getPerm("VFPEmp");
        btnAfis.Enabled                = FormSession.getPerm("FPVerify");
    }
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public void RedirectPage()
    {
        FormSession.FillSession("", null);
        PermSideMenu();
        foreach (Control ctrl in this.Controls)
        {
            if (ctrl is LinkButton)
            {
                LinkButton lb = (LinkButton)ctrl;
                string id = lb.ID;
                if (lb.Enabled) { Response.Redirect(lb.PostBackUrl); break; }
            }
        }
    }
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
}